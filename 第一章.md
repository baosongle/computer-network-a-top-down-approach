# 计算机网络和英特网

英特网将世界上数以亿计的计算机连接在了一起，包括台式机、笔记本电脑、手机、服务器等等，我么将网络上的计算机成为**终端（end system）或者主机（host）**。除了终端外，组成网络的另一个重要部分就是**网络链路（communication links）** 和**packet switch**，他们让网络中的终端能够互相交换信息（packet）。packet switch 又能分为**路由器（router）**和**交换机（link-layer switch）**

提供互联网服务的企业叫做**ISP（Internet Service Provider）**

终端之间如何组织和交换信息，需要遵守**协议（Protocol）**，比如我们开发中最近常用到的 HTTP 协议、在 HTTP 之下的 TCP 和 IP 协议等等

协议的起草是交给叫做**IETF（Internet Engineering Task Force）**的组织完成的，IETF 每完成一个协议都会给出一份**RFC（Request For Comments）**的文档

## 接入英特网

目前主流的接入英特网的链路有 DSL（Digital Subscriber Line）和电缆（cable），以及最新的光纤。

DSL 接入服务有电话公司提供，终端发出和接受的信息与电话信号同时传输的 DSL 链路上，DSL 上传、下载和电话信号的处于链路上的不同频点，因此三者可以在链路上同时传输，用户端必须安装 DSL 调制解调器才能上网

电缆传输与 DSL 类似，不过物理链路是电缆，ISP 则是当地的电视公司，用户端同样需要安装电缆调制解调器才能上网。与 DSL 不同的是，在使用电缆时，你和你的邻居会共享带宽，意味着在上网的高峰期，你的感受到的网络带宽比电视公司承诺的要小得多

光纤是现在最新的物理链路，光纤可以提供更大的带宽、更低的延迟

## 分组交换
分组交换使用了叫做 **转储转发传输（store-and-forward-transimission）**  的方法去转发分组。这个方法要求交换机或路由器在收到分组的第一个字节后，必须先暂存起来，待收到完整的分组后才能向下个节点发出分组的内容，这就是转发时延。因此在分组从起点到终点的路由中，路由器越多就会导致越大的延迟

路由器内有一个叫做 **输出缓存（output buffer）** 的缓存队列，当一个分组到达了路由器需要发送到下个节点，但是到达下个节点的物理链路非常繁忙的话，分组必须在输出缓存内等待直到链路空闲下来，这就是排队时延。如果当一个分组到达了路由器，且路由器内的输出缓存已满，那么这个分组就不得不被丢弃，这就是网络中的丢包现象

## 电路交换
另外一种在路由器之间转发分组的方法叫做 **电路交换（circuit switches）** 。电路交换与分组交换的最大区别在于，当一个主机准备向另一个主机发送分组之前，必须先建立连接。这里的建立连接不是指物理上的连接（物理上的连接肯定已经事先建立好了），而是指的抽象上的连接。电路交换网络中一个物理链路使用 **频分复用（Frenquency-Division Multiplexing）** 或 **时分复用（Time-Division Multiplexing）** 算法分成多个抽象连接。在发送分组之前，两个主机必须先占用一个连接，在主机放弃这个之前之前，任何其他主机不能使用这个连接。

分组交换和电路交换之间的不同

1. 分组交换中链路是所有主机共享的，每台主机都可以在任何时候向网络中发送分组；但是在电路交换中，主机必须在发送分组之前先占用一个连接。
2. 分组交换对于网络的并发数并没有什么限制，但是当网络太繁忙时可能会有丢包现象的发生；电路交换的网络并发数较低，但是每条连接都能提供相对高质量的网络服务。
3. 分组交换的网络利用率更高，因为在电路交换中，每个主机会独占一个连接，即使当它不使用网络发送数据时，只要它不放弃连接，其他主机只能干等着
4. 分组交换实现起来更简单

因此，分组交换是现在网络中的主流

## 时延

一个分组从网络的一端传递到另一端所经历的时间，就是节点总时延，节点总时延是**节点处理时延**、**排队时延**、**传输时延**和**传播时延**的总和

- 节点处理时延：是路由器检查分组的目的地、对分组进行校验等操作的时延，这与路由器的性能有关，这个时延通常是微秒级别的
- 排队时延：当分组到达路由器且输出队列非空时，分组必须在输出队列中排队，从到达队列到从队列中弹出的时间就是排队时延，排队时延是毫秒到微秒量级的
- 传输时延：传输时延是交换机把分组放到物理链路上的时延，它等于分组的长度除以链路的速率，通常是毫秒到微秒量级的
- 传播时延：是分组从物理链路的一端传播到另一端的时延，通常是毫秒级的

