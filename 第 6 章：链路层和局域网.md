# 第 6 章：链路层和局域网

链路层提供的基本服务是将数据报通过单一通信链路从一个节点移动到相邻节点。不同链路层协议提供的服务不同，基本上包括了下面协议

- **成帧（framing）**：将上层传下来的数据包装成链路层帧
- **链路接入**：媒体访问控制（Medium Access Control，MAC）规定了帧在链路上的传递规则，使得帧在有单一的发送方和接收方、或者多个发送方和接收方的情况下都能被正确传输
- **可靠交付**：运有些输层协议提供可靠交付，有些链路层协议也提供可靠交付功能，但并不是全部
- **差错检测和纠错**：由于链路层中的硬件可能发生硬件故障，故有时候数据报中的比特会发生翻转，链路层协议能够检测出这样的差错，有时候甚至能纠正错误

## 差错检测和纠错技术

链路层接到上层的应用数据后，加上自己的首部组成链路层数据报，放在链路中进行传播。传播中可能发生错误，因此需要有差错检测机制来发现链路层首部和应用数据的错误。差错检测可能并不能找到所有的错误，因此链路层可能向上层交付一个有差错的数据报，但是这种事情的发生概率比较低

差错检测常用的 3 种技术分别是：**奇偶校验**、**检验和方法**、**循环冗余检测**

**奇偶校验** 方法是其中最简单的一种。如果要发送 d 比特的数据，在这些数据的最后附加一个比特，共 d+1 比特，附加的比特使得所有的比特位中的 1 的个数是偶数。这样，当接收方收到数据后，只需要检查 d+1 比特的数据中的 1 的个数是不是偶数，如果不是则必定在传输过程中发生了错误；但是如果是，也并不意味着一定没有发生错误，因为有可能在两个地方发生了比特翻转使得 1 的个数仍为偶数，当然这样的事情发生的概率是比较低的

上面这样的奇偶校验方法是一维奇偶校验，后来还出现了 **二维奇偶校验** 方法。将所有的数据分为 i 行 j 列，对每一行附加一个比特，对每一列也附加一个比特，这样总共就附加了 i+j+1 比特。每一行和每一列的附加比特都让行和列的数字 1 的数量是偶数。当某一个比特数据发生错误后，我们发现在第 n 行和第 m 列的数字 1 的个数不是偶数，那么发生错误的数据就是 n 行 m 列的数据，这样我们就能把该比特数据翻转到另一个值，我们就纠正了数据错误，这种能力叫做 **前向纠错**。二维奇偶校验同样能发现多于一个比特的数据错误，但这种情况下就不能纠正错误了